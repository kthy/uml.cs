os: linux
dist: bionic
language: python
python: 
    - '3.6'
    - '3.7'
    - '3.8'
git:
    depth: false
cache: pip
before_install:
    - python --version
    - pip install codecov
    - pip install pipenv
install:
    - pipenv sync
    - pipenv install pytest_cov # argh!
addons:
    sonarcloud:
        organization: kthy
script:
    - pytest --version
    - python -m umldotcs -o tests_sln.gv ./tests/sln/
    - python -m pytest --cov-branch --cov-report term-missing:skip-covered --cov-report xml --cov=umldotcs tests/
after_success:
    - codecov
    - sonar-scanner
